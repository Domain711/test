<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <meta charset="utf-8"/>
        <title>编辑菜单</title>

        <meta name="description" content="Common form elements and layouts"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"/>

        <!-- bootstrap & fontawesome -->
        <link rel="stylesheet" href="/css/bootstrap.min.css"/>
        <link rel="stylesheet" href="/css/font-awesome.min.css"/>
        <link rel="stylesheet" type="text/css" href="/css/layui.css"/>


        <!-- page specific plugin styles -->

        <!-- text fonts -->
        <link rel="stylesheet" href="/css/fonts.googleapis.com.css"/>

        <!-- ace styles -->
        <link rel="stylesheet" href="/css/ace.min.css" class="ace-main-stylesheet" id="main-ace-style"/>

        <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ace-part2.min.css" class="ace-main-stylesheet"/>
        <![endif]-->
        <link rel="stylesheet" href="/css/ace-skins.min.css"/>
        <link rel="stylesheet" href="/css/ace-rtl.min.css"/>

        <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ace-ie.min.css"/>
        <![endif]-->

        <!-- inline styles related to this page -->

        <!-- ace settings handler -->
        <script src="/js/ace-extra.min.js"></script>

        <!-- HTML5shiv and Respond.js for IE8 to support HTML5 elements and media queries -->

        <!--[if lte IE 8]>
        <script src="/js/html5shiv.min.js"></script>
        <script src="/js/respond.min.js"></script>
        <![endif]-->
    </head>

    <body class="no-skin">

        <div class="main-container ace-save-state" id="main-container">
            <div class="main-content">
                <div class="main-content-inner">
                    <div class="page-content">
                        <div class="row">
                            <div class="col-xs-12">
                                <form class="form-horizontal" role="form" method="post">
                                    <input type="hidden" name="id" th:value="${menu.id}"/>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1">菜单名称
                                        </label>

                                        <div class="col-sm-9">
                                            <input type="text" id="form-field-1" name="menuName"
                                                   th:value="${menu.menuName}" placeholder="请输入菜单名称"
                                                   class="col-xs-10 col-sm-5"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1-2">
                                            菜单路径
                                        </label>

                                        <div class="col-sm-9">
                                            <input type="text" id="form-field-1-2" name="menuUrl"
                                                   th:value="${menu.menuUrl}" placeholder="菜单路径"
                                                   class="col-xs-10 col-sm-5"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1-8">参数
                                        </label>

                                        <div class="col-sm-9">
                                            <input type="text" id="form-field-1-8" name="menuParam"
                                                   th:value="${menu.menuParam}" placeholder="菜单路径参数"
                                                   class="col-xs-10 col-sm-5"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1-9">
                                            路径授权规则
                                        </label>

                                        <div class="col-sm-9">
                                            <input type="text" id="form-field-1-9" name="menuRole"
                                                   th:value="${menu.menuRole}" placeholder="路径授权规则"
                                                   class="col-xs-10 col-sm-5"/>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right">请求方式</label>

                                        <div class="col-sm-9">
                                            <select class="form-control" id="form-field-select-1" name="acessType">
                                                <option th:selected="${menu.acessType=='GET'}" value="GET">GET</option>
                                                <option th:selected="${menu.acessType=='POST'}" value="POST">POST
                                                </option>
                                                <option th:selected="${menu.acessType=='PUT'}" value="PUT">PUT</option>
                                                <option th:selected="${menu.acessType=='DELETE'}" value="DELETE">
                                                    DELETE
                                                </option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right">上级目录</label>

                                        <div class="col-sm-9">
                                            <input type="text" lay-filter="tree" placeholder="上级目录"
                                                   class="col-xs-10 col-sm-5" id="selectParentMenu"/>
                                            <input type="hidden" name="pid" th:value="${menu.pid}"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right">菜单类型</label>

                                        <div class="col-sm-9">
                                            <select class="form-control" id="form-field-select-3" name="menuType">
                                                <option th:selected="${menu.menuType==0}" value="0">可视化菜单</option>
                                                <option th:selected="${menu.menuType==1}" value="1">非可视化</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right">显示位置</label>

                                        <div class="col-sm-9">
                                            <select class="form-control" id="form-field-select-4" name="menuPosation">
                                                <option th:selected="${menu.menuPosation==0}" value="0">左侧</option>
                                                <option th:selected="${menu.menuPosation==1}" value="1">顶部</option>
                                            </select>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1-7">
                                            菜单图标
                                        </label>
                                        <div class="col-sm-9">
                                            <input type="text" name="menuIcon" th:value="${menu.menuIcon}"
                                                   id="form-field-1-7" placeholder="菜单图标"
                                                   class="col-xs-10 col-sm-5"/>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1-3">
                                            显示顺序
                                        </label>

                                        <div class="col-sm-9">
                                            <input type="text" name="menuOrder" th:value="${menu.menuOrder}"
                                                   id="form-field-1-3" placeholder="菜单显示顺序"
                                                   class="col-xs-10 col-sm-5"/>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-3 control-label no-padding-right" for="form-field-1-4">备注
                                        </label>

                                        <div class="col-sm-9">
                                            <input type="text" name="menuRemark" th:value="${menu.menuRemark}"
                                                   id="form-field-1-4" placeholder="备注"
                                                   class="col-xs-10 col-sm-5"/>
                                        </div>
                                    </div>
                                    <div class="clearfix" style="margin-left: 30%">
                                        <div class="col-md-offset-3 col-md-9">
                                            <button class="btn btn-info" type="button" th:onclick="'saveUser()'">
                                                <i class="ace-icon fa fa-check bigger-110"></i>
                                                提交
                                            </button>
                                        </div>
                                    </div>
                                </form>

                            </div><!-- /.col -->
                        </div><!-- /.row -->
                    </div><!-- /.page-content -->
                </div>
            </div><!-- /.main-content -->

        </div><!-- /.main-container -->

        <!-- basic scripts -->

        <!--[if !IE]> -->
        <script src="/js/jquery-2.1.4.min.js"></script>

        <!-- <![endif]-->

        <!--[if IE]>
        <script src="/js/jquery-1.11.3.min.js"></script>
        <![endif]-->
        <script type="text/javascript">
            if ('ontouchstart' in document.documentElement) document.write("<script src='/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
        </script>
        <script src="/js/bootstrap.min.js"></script>

        <!-- page specific plugin scripts -->

        <!--[if lte IE 8]>
        <script src="/js/excanvas.min.js"></script>
        <![endif]-->

        <!-- ace scripts -->
        <script src="/js/ace-elements.min.js"></script>
        <script src="/js/ace.min.js"></script>
        <script src="/layer/layer.js"></script>
        <script type="text/javascript" src="layer/layui.js"></script>
        <script type="text/javascript">
            layui.use(['treeSelect', 'form'], function () {
                var treeSelect = layui.treeSelect;

                treeSelect.render({
                    // 选择器
                    elem: '#selectParentMenu',
                    // 数据
                    data: 'getParentMenu',
                    // 异步加载方式：get/post，默认get
                    type: 'get',
                    // 占位符
                    placeholder: '修改默认提示信息',
                    // 是否开启搜索功能：true/false，默认false
                    search: true,
                    // 点击回调 d就是id
                    click: function (d) {
                        $("input[name='pid']").val(d);
                        console.log(d);
                    },
                    // 加载完成后的回调函数
                    success: function (d) {
//                选中节点，根据id筛选
                        var id = $("input[name='pid']").val();
                        treeSelect.checkNode('tree', id);

//                获取zTree对象，可以调用zTree方法
//                var treeObj = treeSelect.zTree('tree');
//                console.log(treeObj);

//                刷新树结构
//                treeSelect.refresh();
                    }
                });
            });

            //保存新菜单
            function saveUser() {
                $.ajax({
                    url: '/saveEditMenu',
                    type: 'PUT',
                    dataType: 'json',
                    data: $(".form-horizontal").serialize(),
                    async: false,
                    success: function (data) {
                        if (data != null && true == data.succeed) {
                            layer.msg("修改成功", {time: 1000}, function () {
                                window.parent.location.reload()
                                layer.close();
                            })
                        } else {
                            layer.msg(data.msg);
                        }
                    }
                })
            }


        </script>

    </body>
</html>
